import org.junit.jupiter.api.Assertions
import org.junit.jupiter.params.ParameterizedTest
import org.junit.jupiter.params.provider.CsvSource
import org.mockito.Mockito
import kotlin.math.abs
import kotlin.math.max

class FinalFunctionTest {
    @ParameterizedTest
    @CsvSource(
        value = [
            " -31.1017672705389 , 0.951056516295153 , 0.30901699437495 , 0.32491969623291 , 1.05146222423827 , 3.23606797749976 , NaN , NaN , NaN , -235.81978742015 ",
            " -30.78760800518 , 0.809016994374947 , 0.587785252292474 , 0.726542528005363 , 1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , -4.31843293955864 ",
            " -30.473448739821 , 0.587785252292474 , 0.809016994374947 , 1.37638192047117 , 1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 3.87230844287776 ",
            " -30.159289474462 , 0.309016994374946 , 0.951056516295154 , 3.07768353717527 , 3.2360679774998 , 1.05146222423827 , NaN , NaN , NaN , 10.1686212299761 ",
            " -29.5309709437441 , -0.309016994374948 , 0.951056516295153 , -3.07768353717524 , -3.23606797749978 , 1.05146222423827 , NaN , NaN , NaN , -5.12983804223034 ",
            " -29.2168116783851 , -0.587785252292473 , 0.809016994374948 , -1.37638192047118 , -1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 5.9705729389541 ",
            " -28.9026524130261 , -0.809016994374948 , 0.587785252292472 , -0.726542528005359 , -1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , 48.6001061263533 ",
            " -28.5884931476671 , -0.951056516295154 , 0.309016994374945 , -0.324919696232903 , -1.05146222423827 , 3.23606797749982 , NaN , NaN , NaN , 1276.07338625533 ",
            " -27.9601746169492 , -0.951056516295154 , -0.309016994374947 , 0.324919696232906 , -1.05146222423827 , -3.2360679774998 , NaN , NaN , NaN , -650.642838870753 ",
            " -27.6460153515902 , -0.809016994374947 , -0.587785252292474 , 0.726542528005363 , -1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , -0.620371708503688 ",
            " -27.3318560862312 , -0.587785252292471 , -0.809016994374949 , 1.37638192047118 , -1.70130161670409 , -1.23606797749979 , NaN , NaN , NaN , 31.7742918097782 ",
            " -27.0176968208722 , -0.309016994374946 , -0.951056516295154 , 3.07768353717526 , -3.2360679774998 , -1.05146222423827 , NaN , NaN , NaN , 155.908229916381 ",
            " -26.3893782901543 , 0.309016994374948 , -0.951056516295153 , -3.07768353717524 , 3.23606797749978 , -1.05146222423827 , NaN , NaN , NaN , 150.676644352174 ",
            " -26.0752190247953 , 0.587785252292475 , -0.809016994374946 , -1.37638192047117 , 1.70130161670407 , -1.23606797749979 , NaN , NaN , NaN , 31.5971093551115 ",
            " -25.7610597594363 , 0.809016994374948 , -0.587785252292472 , -0.726542528005359 , 1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , 20.7650410654088 ",
            " -25.4469004940773 , 0.951056516295153 , -0.309016994374948 , -0.324919696232907 , 1.05146222423827 , -3.23606797749978 , NaN , NaN , NaN , 408.424957488909 ",
            " -24.8185819633594 , 0.951056516295153 , 0.30901699437495 , 0.324919696232909 , 1.05146222423827 , 3.23606797749976 , NaN , NaN , NaN , -235.819787420151 ",
            " -24.5044226980004 , 0.809016994374947 , 0.587785252292474 , 0.726542528005362 , 1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , -4.31843293955866 ",
            " -24.1902634326414 , 0.587785252292474 , 0.809016994374947 , 1.37638192047117 , 1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 3.87230844287776 ",
            " -23.8761041672824 , 0.309016994374947 , 0.951056516295154 , 3.07768353717526 , 3.2360679774998 , 1.05146222423827 , NaN , NaN , NaN , 10.1686212299761 ",
            " -23.2477856365645 , -0.309016994374948 , 0.951056516295153 , -3.07768353717524 , -3.23606797749978 , 1.05146222423827 , NaN , NaN , NaN , -5.12983804223035 ",
            " -22.9336263712055 , -0.587785252292473 , 0.809016994374948 , -1.37638192047118 , -1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 5.97057293895409 ",
            " -22.6194671058465 , -0.809016994374948 , 0.587785252292473 , -0.72654252800536 , -1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , 48.6001061263532 ",
            " -22.3053078404875 , -0.951056516295154 , 0.309016994374945 , -0.324919696232903 , -1.05146222423827 , 3.23606797749982 , NaN , NaN , NaN , 1276.07338625532 ",
            " -21.6769893097696 , -0.951056516295154 , -0.309016994374947 , 0.324919696232905 , -1.05146222423827 , -3.2360679774998 , NaN , NaN , NaN , -650.642838870756 ",
            " -21.3628300444106 , -0.809016994374947 , -0.587785252292474 , 0.726542528005362 , -1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , -0.620371708503729 ",
            " -21.0486707790516 , -0.587785252292471 , -0.809016994374949 , 1.37638192047118 , -1.70130161670409 , -1.23606797749979 , NaN , NaN , NaN , 31.7742918097782 ",
            " -20.7345115136926 , -0.309016994374947 , -0.951056516295154 , 3.07768353717526 , -3.2360679774998 , -1.05146222423827 , NaN , NaN , NaN , 155.908229916381 ",
            " -20.1061929829747 , 0.309016994374948 , -0.951056516295153 , -3.07768353717525 , 3.23606797749978 , -1.05146222423827 , NaN , NaN , NaN , 150.676644352174 ",
            " -19.7920337176157 , 0.587785252292475 , -0.809016994374946 , -1.37638192047117 , 1.70130161670407 , -1.23606797749979 , NaN , NaN , NaN , 31.5971093551116 ",
            " -19.4778744522567 , 0.809016994374948 , -0.587785252292473 , -0.72654252800536 , 1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , 20.7650410654088 ",
            " -19.1637151868977 , 0.951056516295153 , -0.309016994374948 , -0.324919696232907 , 1.05146222423827 , -3.23606797749978 , NaN , NaN , NaN , 408.424957488907 ",
            " -18.5353966561798 , 0.951056516295153 , 0.30901699437495 , 0.324919696232909 , 1.05146222423827 , 3.23606797749976 , NaN , NaN , NaN , -235.819787420152 ",
            " -18.2212373908208 , 0.809016994374947 , 0.587785252292474 , 0.726542528005362 , 1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , -4.31843293955867 ",
            " -17.9070781254618 , 0.587785252292474 , 0.809016994374947 , 1.37638192047117 , 1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 3.87230844287776 ",
            " -17.5929188601028 , 0.309016994374947 , 0.951056516295154 , 3.07768353717526 , 3.2360679774998 , 1.05146222423827 , NaN , NaN , NaN , 10.1686212299761 ",
            " -16.9646003293849 , -0.309016994374948 , 0.951056516295153 , -3.07768353717525 , -3.23606797749978 , 1.05146222423827 , NaN , NaN , NaN , -5.12983804223036 ",
            " -16.6504410640259 , -0.587785252292472 , 0.809016994374948 , -1.37638192047118 , -1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 5.97057293895407 ",
            " -16.3362817986669 , -0.809016994374948 , 0.587785252292473 , -0.72654252800536 , -1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , 48.6001061263532 ",
            " -16.0221225333079 , -0.951056516295154 , 0.309016994374945 , -0.324919696232904 , -1.05146222423827 , 3.23606797749981 , NaN , NaN , NaN , 1276.07338625532 ",
            " -15.39380400259 , -0.951056516295153 , -0.309016994374948 , 0.324919696232907 , -1.05146222423827 , -3.23606797749978 , NaN , NaN , NaN , -650.642838870738 ",
            " -15.079644737231 , -0.809016994374947 , -0.587785252292474 , 0.726542528005362 , -1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , -0.620371708503768 ",
            " -14.765485471872 , -0.587785252292473 , -0.809016994374948 , 1.37638192047118 , -1.70130161670408 , -1.23606797749979 , NaN , NaN , NaN , 31.7742918097779 ",
            " -14.451326206513 , -0.309016994374947 , -0.951056516295154 , 3.07768353717526 , -3.2360679774998 , -1.05146222423827 , NaN , NaN , NaN , 155.908229916381 ",
            " -13.8230076757951 , 0.309016994374948 , -0.951056516295153 , -3.07768353717525 , 3.23606797749978 , -1.05146222423827 , NaN , NaN , NaN , 150.676644352174 ",
            " -13.5088484104361 , 0.587785252292474 , -0.809016994374947 , -1.37638192047117 , 1.70130161670408 , -1.23606797749979 , NaN , NaN , NaN , 31.5971093551118 ",
            " -13.1946891450771 , 0.809016994374948 , -0.587785252292473 , -0.72654252800536 , 1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , 20.7650410654088 ",
            " -12.8805298797182 , 0.951056516295154 , -0.309016994374947 , -0.324919696232906 , 1.05146222423827 , -3.23606797749979 , NaN , NaN , NaN , 408.424957488917 ",
            " -12.2522113490002 , 0.951056516295153 , 0.309016994374948 , 0.324919696232907 , 1.05146222423827 , 3.23606797749978 , NaN , NaN , NaN , -235.81978742016 ",
            " -11.9380520836412 , 0.809016994374947 , 0.587785252292473 , 0.726542528005362 , 1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , -4.31843293955869 ",
            " -11.6238928182822 , 0.587785252292473 , 0.809016994374948 , 1.37638192047118 , 1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 3.87230844287778 ",
            " -11.3097335529233 , 0.309016994374947 , 0.951056516295154 , 3.07768353717526 , 3.23606797749979 , 1.05146222423827 , NaN , NaN , NaN , 10.168621229976 ",
            " -10.6814150222053 , -0.309016994374948 , 0.951056516295153 , -3.07768353717525 , -3.23606797749979 , 1.05146222423827 , NaN , NaN , NaN , -5.12983804223037 ",
            " -10.3672557568463 , -0.587785252292473 , 0.809016994374947 , -1.37638192047117 , -1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 5.97057293895414 ",
            " -10.0530964914873 , -0.809016994374948 , 0.587785252292473 , -0.72654252800536 , -1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , 48.6001061263531 ",
            " -9.73893722612836 , -0.951056516295154 , 0.309016994374947 , -0.324919696232906 , -1.05146222423827 , 3.23606797749979 , NaN , NaN , NaN , 1276.07338625528 ",
            " -9.1106186954104 , -0.951056516295153 , -0.309016994374948 , 0.324919696232907 , -1.05146222423827 , -3.23606797749979 , NaN , NaN , NaN , -650.642838870741 ",
            " -8.79645943005142 , -0.809016994374947 , -0.587785252292473 , 0.726542528005361 , -1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , -0.620371708503798 ",
            " -8.48230016469244 , -0.587785252292473 , -0.809016994374948 , 1.37638192047117 , -1.70130161670408 , -1.23606797749979 , NaN , NaN , NaN , 31.7742918097778 ",
            " -8.16814089933346 , -0.309016994374947 , -0.951056516295154 , 3.07768353717526 , -3.23606797749979 , -1.05146222423827 , NaN , NaN , NaN , 155.908229916381 ",
            " -7.5398223686155 , 0.309016994374948 , -0.951056516295153 , -3.07768353717525 , 3.23606797749979 , -1.05146222423827 , NaN , NaN , NaN , 150.676644352175 ",
            " -7.22566310325652 , 0.587785252292473 , -0.809016994374947 , -1.37638192047117 , 1.70130161670408 , -1.23606797749979 , NaN , NaN , NaN , 31.5971093551118 ",
            " -6.91150383789755 , 0.809016994374947 , -0.587785252292473 , -0.72654252800536 , 1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , 20.7650410654088 ",
            " -6.59734457253857 , 0.951056516295154 , -0.309016994374947 , -0.324919696232906 , 1.05146222423827 , -3.23606797749979 , NaN , NaN , NaN , 408.424957488915 ",
            " -5.96902604182061 , 0.951056516295153 , 0.309016994374948 , 0.324919696232907 , 1.05146222423827 , 3.23606797749979 , NaN , NaN , NaN , -235.819787420161 ",
            " -5.65486677646163 , 0.809016994374947 , 0.587785252292473 , 0.726542528005361 , 1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , -4.3184329395587 ",
            " -5.34070751110265 , 0.587785252292473 , 0.809016994374947 , 1.37638192047117 , 1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 3.87230844287778 ",
            " -5.02654824574367 , 0.309016994374947 , 0.951056516295154 , 3.07768353717526 , 3.23606797749979 , 1.05146222423827 , NaN , NaN , NaN , 10.168621229976 ",
            " -4.39822971502571 , -0.309016994374948 , 0.951056516295153 , -3.07768353717525 , -3.23606797749979 , 1.05146222423827 , NaN , NaN , NaN , -5.12983804223038 ",
            " -4.08407044966673 , -0.587785252292473 , 0.809016994374947 , -1.37638192047117 , -1.70130161670408 , 1.23606797749979 , NaN , NaN , NaN , 5.97057293895413 ",
            " -3.76991118430775 , -0.809016994374947 , 0.587785252292473 , -0.726542528005361 , -1.23606797749979 , 1.70130161670408 , NaN , NaN , NaN , 48.600106126353 ",
            " -3.45575191894877 , -0.951056516295154 , 0.309016994374947 , -0.324919696232906 , -1.05146222423827 , 3.23606797749979 , NaN , NaN , NaN , 1276.07338625527 ",
            " -2.82743338823081 , -0.951056516295153 , -0.309016994374947 , 0.324919696232906 , -1.05146222423827 , -3.23606797749979 , NaN , NaN , NaN , -650.642838870745 ",
            " -2.51327412287183 , -0.809016994374947 , -0.587785252292473 , 0.726542528005361 , -1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , -0.620371708503827 ",
            " -2.19911485751286 , -0.587785252292473 , -0.809016994374947 , 1.37638192047117 , -1.70130161670408 , -1.23606797749979 , NaN , NaN , NaN , 31.7742918097778 ",
            " -1.88495559215388 , -0.309016994374947 , -0.951056516295154 , 3.07768353717525 , -3.23606797749979 , -1.05146222423827 , NaN , NaN , NaN , 155.90822991638 ",
            " -1.25663706143592 , 0.309016994374947 , -0.951056516295153 , -3.07768353717525 , 3.23606797749979 , -1.05146222423827 , NaN , NaN , NaN , 150.676644352175 ",
            " -0.942477796076938 , 0.587785252292473 , -0.809016994374947 , -1.37638192047117 , 1.70130161670408 , -1.23606797749979 , NaN , NaN , NaN , 31.5971093551119 ",
            " -0.628318530717959 , 0.809016994374947 , -0.587785252292473 , -0.726542528005361 , 1.23606797749979 , -1.70130161670408 , NaN , NaN , NaN , 20.7650410654088 ",
            " -0.314159265358979 , 0.951056516295153 , -0.309016994374947 , -0.324919696232906 , 1.05146222423827 , -3.23606797749979 , NaN , NaN , NaN , 408.424957488914 ",
            " 0.1 , 0.995004165278026 , 0.099833416646828 , 0.100334672085451 , 1.00502091840046 , 10.0166861316348 , -3.32192809488736 , -1.43067655807339 , -1 , 6.44828237688259 ",
            " 0.2 , 0.980066577841242 , 0.198669330795061 , 0.202710035508672 , 1.02033884494119 , 5.03348954767234 , -2.32192809488736 , -1 , -0.698970004336019 , 3.90301490280937 ",
            " 0.3 , 0.955336489125606 , 0.29552020666134 , 0.309336249609623 , 1.04675160153809 , 3.38386336182412 , -1.73696559416621 , -0.748070363587408 , -0.522878745280338 , 2.80274065193476 ",
            " 0.4 , 0.921060994002885 , 0.38941834230865 , 0.422793218738162 , 1.08570442838324 , 2.56793245554778 , -1.32192809488736 , -0.569323441926607 , -0.397940008672038 , 2.17608547054653 ",
            " 0.5 , 0.877582561890373 , 0.479425538604203 , 0.54630248984379 , 1.13949392732455 , 2.08582964293349 , -1 , -0.430676558073393 , -0.301029995663981 , 1.77050492836856 ",
            " 0.6 , 0.825335614909678 , 0.564642473395035 , 0.684136808341692 , 1.21162831451232 , 1.77103219668773 , -0.736965594166206 , -0.317393805514015 , -0.221848749616356 , 1.48762282283371 ",
            " 0.7 , 0.764842187284488 , 0.644217687237691 , 0.842288380463079 , 1.30745925973359 , 1.5522703269571 , -0.514573172829758 , -0.221614602951225 , -0.154901959985743 , 1.28038310041634 ",
            " 0.8 , 0.696706709347165 , 0.717356090899523 , 1.02963855705036 , 1.43532419967224 , 1.39400781938864 , -0.321928094887362 , -0.138646883853214 , -0.096910013008056 , 1.12321122640671 ",
            " 0.9 , 0.621609968270664 , 0.783326909627483 , 1.26015821755034 , 1.60872581046605 , 1.2766062134589 , -0.15200309344505 , -0.065464169101423 , -0.045757490560675 , 1.00092903192573 ",
            " 1.1 , 0.453596121425577 , 0.891207360061435 , 1.96475965724865 , 2.20460438871736 , 1.1220733185272 , 0.137503523749935 , 0.059219544331585 , 0.041392685158225 , 0.825812106022033 ",
            " 1.2 , 0.362357754476673 , 0.932039085967226 , 2.57215162212632 , 2.75970360133241 , 1.0729163777099 , 0.263034405833794 , 0.113282752559378 , 0.079181246047625 , 0.762160122951545 ",
            " 1.3 , 0.267498828624587 , 0.963558185417193 , 3.60210244796798 , 3.73833412707544 , 1.0378200456748 , 0.37851162325373 , 0.163016083093689 , 0.113943352306837 , 0.70981026868108 ",
            " 1.4 , 0.169967142900241 , 0.98544972998846 , 5.79788371548289 , 5.88349008482735 , 1.01476510629488 , 0.485426827170242 , 0.209061955122168 , 0.146128035678238 , 0.666443527123439 ",
            " 1.5 , 0.070737201667703 , 0.997494986604055 , 14.1014199471717 , 14.1368329029699 , 1.00251130424672 , 0.584962500721156 , 0.251929636412592 , 0.176091259055681 , 0.630320045481798 ",
            " 1.6 , -0.029199522301289 , 0.999573603041505 , -34.2325327355573 , -34.2471356100186 , 1.00042657885042 , 0.678071905112638 , 0.292029674220179 , 0.204119982655925 , 0.600109316702555 ",
            " 1.7 , -0.128844494295525 , 0.991664810452468 , -7.69660213945915 , -7.76129399605034 , 1.00840524889023 , 0.765534746362977 , 0.329697869649195 , 0.230448921378274 , 0.574776931049792 ",
            " 1.8 , -0.227202094693087 , 0.973847630878195 , -4.28626167462806 , -4.40136787185363 , 1.02685468269633 , 0.84799690655495 , 0.365212388971971 , 0.255272505103306 , 0.553507006783634 ",
            " 1.9 , -0.323289566863504 , 0.946300087687414 , -2.92709751467777 , -3.09320220167269 , 1.05674723379115 , 0.925999418556223 , 0.398806242361757 , 0.278753600952829 , 0.535647807721613 ",
            " 2 , -0.416146836547142 , 0.909297426825682 , -2.18503986326152 , -2.40299796172238 , 1.09975017029462 , 1 , 0.430676558073393 , 0.301029995663981 , 0.520672828365283 ",
            " 2.1 , -0.504846104599858 , 0.863209366648874 , -1.70984654290451 , -1.98080165596722 , 1.15846750352371 , 1.0703893278914 , 0.46099159153476 , 0.322219294733919 , 0.50815243763536 ",
            " 2.2 , -0.588501117255346 , 0.80849640381959 , -1.37382305676879 , -1.69923211813735 , 1.23686388124386 , 1.13750352374994 , 0.489896102404978 , 0.342422680822206 , 0.497732879240477 ",
            " 2.3 , -0.666276021279824 , 0.74570521217672 , -1.11921364173413 , -1.50087946746025 , 1.34101248545788 , 1.20163386116965 , 0.517515535392987 , 0.361727836017593 , 0.489120492411693 ",
            " 2.4 , -0.737393715541246 , 0.675463180551151 , -0.91601428967341 , -1.35612764107435 , 1.48046559574726 , 1.26303440583379 , 0.543959310632771 , 0.380211241711606 , 0.482069698600904 ",
            " 2.5 , -0.801143615546934 , 0.598472144103957 , -0.74702229723866 , -1.24821565146882 , 1.67092154555868 , 1.32192809488736 , 0.569323441926607 , 0.397940008672038 , 0.476373745730505 ",
            " 2.6 , -0.856888753368947 , 0.515501371821464 , -0.601596613089759 , -1.16701263269986 , 1.93985904725455 , 1.37851162325373 , 0.593692641167082 , 0.414973347970818 , 0.471857499149465 ",
            " 2.7 , -0.904072142017061 , 0.42737988023383 , -0.472727629103037 , -1.10610641952634 , 2.33983873890572 , 1.43295940727611 , 0.617142025384563 , 0.431363764158987 , 0.468371770607193 ",
            " 2.8 , -0.942222340668658 , 0.334988150155905 , -0.355529831651176 , -1.06132062129873 , 2.98518022065735 , 1.48542682717024 , 0.639738513195561 , 0.447158031342219 , 0.465788816173197 ",
            " 2.9 , -0.970958165149591 , 0.239249329213982 , -0.246405393971966 , -1.02991049037209 , 4.17974003641035 , 1.53605290024021 , 0.661541976094107 , 0.462397997898956 , 0.463998731919583 ",
            " 3 , -0.989992496600445 , 0.141120008059867 , -0.142546543074278 , -1.01010866590799 , 7.08616739573719 , 1.58496250072116 , 0.682606194485985 , 0.477121254719662 , 0.462906545773872 ",
            " 3.1 , -0.999135150273279 , 0.041580662433291 , -0.041616654585636 , -1.00086559833921 , 24.0496409022906 , 1.63226821549951 , 0.70297965690393 , 0.491361693834273 , 0.4624298540588 ",
            " 3.2 , -0.998294775794753 , -0.05837414342758 , 0.058473854459579 , -1.00170813696174 , -17.1308723568786 , 1.67807190511264 , 0.722706232293572 , 0.505149978319906 , 0.462496887746711 ",
            " 3.3 , -0.987479769908865 , -0.157745694143249 , 0.159745747660033 , -1.01267897375993 , -6.3393172500284 , 1.72246602447109 , 0.74182573881757 , 0.518513939877887 , 0.463044920352874 ",
            " 3.4 , -0.966798192579461 , -0.255541102026832 , 0.264316900867426 , -1.03434202471144 , -3.91326480189868 , 1.76553474636298 , 0.760374427722588 , 0.531478917042255 , 0.464018949409741 ",
            " 3.5 , -0.936456687290796 , -0.35078322768962 , 0.374585640158595 , -1.06785504719181 , -2.85076343754046 , 1.8073549220576 , 0.778385397048775 , 0.544068044350276 , 0.465370598505007 ",
            " 3.6 , -0.896758416334147 , -0.442520443294852 , 0.493466729984904 , -1.11512753243833 , -2.25978260474104 , 1.84799690655495 , 0.795888947045364 , 0.556302500767287 , 0.467057198268925 ",
            " 3.7 , -0.848100031710408 , -0.529836140908493 , 0.624733075224564 , -1.17910619338529 , -1.88737596926727 , 1.88752527074159 , 0.812912886879536 , 0.568201724066995 , 0.469041013413384 ",
            " 3.8 , -0.790967711914417 , -0.611857890942719 , 0.773556090503126 , -1.26427410997555 , -1.63436643508716 , 1.92599941855622 , 0.829482800435151 , 0.57978359661681 , 0.471288589641753 ",
            " 3.9 , -0.72593230420014 , -0.687766159183974 , 0.947424649935893 , -1.37753891680277 , -1.45398255881983 , 1.96347412397489 , 0.845622277579675 , 0.591064607026499 , 0.473770199462038 ",
            " 4 , -0.653643620863612 , -0.756802495307928 , 1.15782128234958 , -1.5298856564664 , -1.3213487088109 , 2 , 0.861353116146786 , 0.602059991327962 , 0.476459370011064 ",
            " 4.1 , -0.574823946533269 , -0.818277111064411 , 1.42352648319437 , -1.73966308472524 , -1.22207988770357 , 2.03562390973072 , 0.876695498974731 , 0.612783856719735 , 0.479332479203779 ",
            " 4.2 , -0.490260821340699 , -0.871575772413588 , 1.77777977450884 , -2.0397306014895 , -1.14734717468199 , 2.0703893278914 , 0.891668149608153 , 0.6232492903979 , 0.48236840906042 ",
            " 4.3 , -0.400799172079975 , -0.916165936749455 , 2.28584787736698 , -2.49501513391465 , -1.09150532658744 , 2.10433665981474 , 0.906288469676671 , 0.633468455579586 , 0.485548247086027 ",
            " 4.4 , -0.307332869978419 , -0.951602073889516 , 3.09632378064975 , -3.25380100107814 , -1.05085941638679 , 2.13750352374994 , 0.920572660478371 , 0.643452676486187 , 0.488855028196039 ",
            " 4.5 , -0.21079579943078 , -0.977530117665097 , 4.63733205455119 , -4.74392754836833 , -1.0229863836713 , 2.16992500144231 , 0.934535830898578 , 0.653212513775344 , 0.492273510985407 ",
            " 4.6 , -0.112152526935054 , -0.993691003633465 , 8.86017489564812 , -8.91642861135966 , -1.00634905251579 , 2.20163386116965 , 0.94819209346638 , 0.662757831681574 , 0.495789983193699 ",
            " 4.7 , -0.012388663462891 , -0.999923257564101 , 80.7127629674748 , -80.7189575368994 , -1.00007674832575 , 2.23266075679027 , 0.961554650079973 , 0.672097857935717 , 0.499392092076523 ",
            " 4.8 , 0.087498983439447 , -0.996164608835841 , -11.3848706542428 , 11.4287042053699 , -1.00385015802623 , 2.26303440583379 , 0.974635868706165 , 0.681241237375587 , 0.50306869609443 ",
            " 4.9 , 0.186512369422576 , -0.982452612624332 , -5.26749306582674 , 5.36157469392461 , -1.01786079771196 , 2.29278174922785 , 0.987447352170942 , 0.690196080028514 , 0.5068097349054 ",
            " 5 , 0.283662185463226 , -0.958924274663139 , -3.38051500624659 , 3.52532008581609 , -1.04283521277141 , 2.32192809488736 , 1 , 0.698970004336019 , 0.510606115120799 ",
            " 5.1 , 0.377977742712981 , -0.925814682327732 , -2.44938941558459 , 2.64565842639934 , -1.08012977012392 , 2.35049724708413 , 1.01230406413518 , 0.707570176097936 , 0.514449609676562 ",
            " 5.2 , 0.468516671300377 , -0.883454655720153 , -1.88564187751976 , 2.1343957670161 , -1.13192000690159 , 2.37851162325373 , 1.02436919924048 , 0.716003343634799 , 0.518332768996795 ",
            " 5.3 , 0.554374336179162 , -0.832267442223901 , -1.50127339580693 , 1.80383530538618 , -1.20153684893392 , 2.40599235967584 , 1.03620450821607 , 0.724275869600789 , 0.52224884239823 ",
            " 5.4 , 0.634692875942635 , -0.772764487555987 , -1.21754082462056 , 1.57556518735903 , -1.29405532488001 , 2.43295940727611 , 1.04781858345796 , 0.732393759822968 , 0.526191708410838 ",
            " 5.5 , 0.70866977429126 , -0.705540325570392 , -0.995584052213885 , 1.41109447062293 , -1.41735342936147 , 2.4594316186373 , 1.05921954433159 , 0.740362689494244 , 0.530155812880288 ",
            " 5.6 , 0.77556587851025 , -0.631266637872321 , -0.813943283689701 , 1.2893811186238 , -1.58411666323836 , 2.48542682717024 , 1.07041507126895 , 0.7481880270062 , 0.534136113878261 ",
            " 5.7 , 0.83471278483916 , -0.550685542597638 , -0.659730571520776 , 1.19801687258533 , -1.81591838289944 , 2.51096191927738 , 1.08141243684774 , 0.755874855672491 , 0.538128032582023 ",
            " 5.8 , 0.885519516941319 , -0.464602179413757 , -0.524666221946799 , 1.12928058712258 , -2.15237905526362 , 2.53605290024021 , 1.0922185341675 , 0.763427993562937 , 0.542127409399377 ",
            " 5.9 , 0.927478430744036 , -0.373876664830236 , -0.403110899873226 , 1.07819218954535 , -2.67467882878987 , 2.56071495447448 , 1.10283990280013 , 0.770852011642144 , 0.54613046471255 ",
            " 6 , 0.960170286650366 , -0.279415498198926 , -0.291006191384749 , 1.04148192659511 , -3.57889954725441 , 2.58496250072116 , 1.11328275255938 , 0.778151250383644 , 0.550133763697632 ",
            " 6.1 , 0.983268438442585 , -0.182162504272095 , -0.185262230689134 , 1.01701627033195 , -5.48960393356421 , 2.60880924267552 , 1.12355298530555 , 0.785329835010767 , 0.55413418474709 ",
            " 6.2 , 0.996542097023217 , -0.083089402817496 , -0.083377714865929 , 1.00346990155972 , -12.0352291157571 , 2.63226821549951 , 1.13365621497732 , 0.792391689498254 , 0.558128891083654 ",
            " 6.3 , 0.999858636383415 , 0.016813900484351 , 0.016816277694183 , 1.00014138360308 , 59.4745996582258 , 2.65535182861255 , 1.14359778602075 , 0.799340549453582 , 0.562115305206034 ",
            " 6.4 , 0.993184918758193 , 0.116549204850494 , 0.117348947461081 , 1.00686184527482 , 8.58006711656913 , 2.67807190511264 , 1.15338279036697 , 0.806179973983887 , 0.566091085851819 ",
            " 6.5 , 0.976587625728024 , 0.215119988087815 , 0.220277200345897 , 1.02397365444245 , 4.64856849839441 , 2.70043971814109 , 1.16301608309369 , 0.812913356642855 , 0.570054107201668 ",
            " 6.6 , 0.950232591958529 , 0.311541363513379 , 0.327858006713134 , 1.05237392240872 , 3.20984664354869 , 2.72246602447109 , 1.17250229689096 , 0.819543935541869 , 0.574002440082394 ",
            " 6.7 , 0.914383148235319 , 0.404849920616598 , 0.442757416732716 , 1.09363345325197 , 2.47005112036819 , 2.74416109557041 , 1.18184585543918 , 0.826074802700826 , 0.577934334955561 ",
            " 6.8 , 0.869397490349825 , 0.494113351138609 , 0.568339978690057 , 1.15022186180641 , 2.02382711921395 , 2.76553474636298 , 1.19105098579598 , 0.832508912706236 , 0.58184820650344 ",
            " 6.9 , 0.815725100125357 , 0.5784397643882 , 0.709111150679694 , 1.22590318704956 , 1.72878847818782 , 2.78659636189081 , 1.20012172987897 , 0.838849090737255 , 0.5857426196461 ",
            " 7 , 0.753902254343305 , 0.656986598718789 , 0.871447982724319 , 1.3264319004737 , 1.52210106256373 , 2.8073549220576 , 1.20906195512217 , 0.845098040014257 , 0.589616276842548 ",
            " 7.1 , 0.684546666442806 , 0.728969040125876 , 1.06489312688338 , 1.46082078698363 , 1.37180037142225 , 2.82781902461732 , 1.21787536437665 , 0.851258348719075 , 0.59346800654553 ",
            " 7.2 , 0.608351314532255 , 0.793667863849153 , 1.30462094005564 , 1.64378702915909 , 1.25997289993597 , 2.84799690655495 , 1.22656550511876 , 0.857332496431268 , 0.597296752694243 ",
            " 7.3 , 0.526077517381105 , 0.850436620628565 , 1.6165614239935 , 1.90086055184064 , 1.17586657928829 , 2.86789646399265 , 1.23513577802321 , 0.863322860120456 , 0.601101565142043 ",
            " 7.4 , 0.43854732757439 , 0.898708095811627 , 2.04928416912809 , 2.2802556009884 , 1.1127083473048 , 2.88752527074159 , 1.24358944495293 , 0.869231719730976 , 0.604881590927474 ",
            " 7.5 , 0.346635317835026 , 0.937999976774739 , 2.70601386677269 , 2.88487626201993 , 1.06609810742048 , 2.90689059560852 , 1.25192963641259 , 0.8750612633917 , 0.608636066306879 ",
            " 7.6 , 0.251259842582255 , 0.967919672031487 , 3.85226569468465 , 3.97994359035957 , 1.03314358504687 , 2.92599941855622 , 1.26015935850854 , 0.880813592280791 , 0.612364309475594 ",
            " 7.7 , 0.153373862037864 , 0.988168233877 , 6.44287247349255 , 6.52001577526374 , 1.01197343298173 , 2.94485844580754 , 1.26828149945375 , 0.886490725172482 , 0.616065713912406 ",
            " 7.8 , 0.053955420562649 , 0.998543345374605 , 18.506821649461 , 18.5338190226666 , 1.00145877956339 , 2.96347412397489 , 1.27629883565307 , 0.89209460269048 , 0.619739742288831 ",
            " 7.9 , -0.046002125639537 , 0.998941341839772 , -21.7151126812545 , -21.7381259256538 , 1.00105978010508 , 2.98185265328974 , 1.28421403740084 , 0.897627091290442 , 0.623385920890746 ",
            " 8 , -0.145500033808614 , 0.989358246623382 , -6.79971145522038 , -6.87285063669037 , 1.0107562184001 , 3 , 1.29202967422018 , 0.903089986991943 , 0.627003834505313 ",
            " 8.1 , -0.243544153735791 , 0.969889810845086 , -3.98239824675599 , -4.10603163599176 , 1.03104495873472 , 3.01792190799726 , 1.29974821987055 , 0.90848501887865 , 0.630593121730861 ",
            " 8.2 , -0.339154860983836 , 0.940730556679772 , -2.77374929538341 , -2.94850557971999 , 1.06300363361153 , 3.03562390973072 , 1.30737205704812 , 0.913813852383717 , 0.63415347067163 ",
            " 8.3 , -0.431376844970621 , 0.902171833756293 , -2.09137751428855 , -2.318158732113 , 1.10843628961058 , 3.05311133645956 , 1.31490348180126 , 0.919078092376074 , 0.63768461498306 ",
            " 8.4 , -0.519288654116686 , 0.85459890808828 , -1.6457107262279 , -1.92571124378022 , 1.17013957136568 , 3.0703893278914 , 1.32234470768155 , 0.924279286061882 , 0.641186330236644 ",
            " 8.5 , -0.602011902684824 , 0.79848711262349 , -1.32636432778561 , -1.66109672506515 , 1.25236836536337 , 3.08746284125034 , 1.3296978696492 , 0.929418925714293 , 0.644658430576378 ",
            " 8.6 , -0.678720047320012 , 0.734397097874113 , -1.08203242378643 , -1.47336151915446 , 1.36166115429205 , 3.10433665981474 , 1.33696502775006 , 0.934498451243567 , 0.648100765641531 ",
            " 8.7 , -0.7486466455974 , 0.662969230082182 , -0.885556936614804 , -1.33574364605885 , 1.50836562939134 , 3.12101540096137 , 1.34414817058009 , 0.939519252618619 , 0.651513217732833 ",
            " 8.8 , -0.811093014061656 , 0.584917192891762 , -0.721146875575603 , -1.232904220186 , 1.70964371051587 , 3.13750352374994 , 1.35124921855176 , 0.944482672150169 , 0.654895699201362 ",
            " 8.9 , -0.865435209241112 , 0.501020856457885 , -0.578923587933547 , -1.15548800109125 , 1.99592489436427 , 3.15380533607904 , 1.35827002697602 , 0.949390006644913 , 0.658248150041309 ",
            " 9 , -0.911130261884677 , 0.412118485241757 , -0.45231565944181 , -1.09753790630496 , 2.42648664355199 , 3.16992500144231 , 1.36521238897197 , 0.954242509439325 , 0.661570535669567 ",
            " 9.1 , -0.947721602131112 , 0.319098362349352 , -0.336700526432874 , -1.05516218871801 , 3.13382993456165 , 3.18586654531133 , 1.37207803821586 , 0.959041392321094 , 0.664862844876616 ",
            " 9.2 , -0.974843621404164 , 0.222889914100246 , -0.228641711559025 , -1.02580555285329 , 4.48651974243323 , 3.20163386116965 , 1.37886865153977 , 0.963787827345555 , 0.668125087934616 ",
            " 9.3 , -0.992225325452603 , 0.124454423507062 , -0.125429597808635 , -1.0078355937386 , 8.03506996232447 , 3.21723071622067 , 1.38558585138992 , 0.968482948553935 , 0.671357294849845 ",
            " 9.4 , -0.999693042035207 , 0.024775425453358 , -0.024783032802668 , -1.00030705221692 , 40.3625762908734 , 3.23266075679028 , 1.39223120815337 , 0.973127853599699 , 0.674559513747803 ",
            " 9.5 , -0.997172156196378 , -0.075151120461809 , 0.075364238757394 , -1.00283586318175 , -13.3065214976826 , 3.24792751344359 , 1.39880624236176 , 0.977723605288848 , 0.677731809380295 ",
            " 9.6 , -0.984687855794127 , -0.174326781222981 , 0.177037606584872 , -1.01555025190549 , -5.73635326129782 , 3.26303440583379 , 1.40531242677956 , 0.982271233039568 , 0.680874261744768 ",
            " 9.7 , -0.96236487983131 , -0.271760626410944 , 0.282388345736994 , -1.03910691355995 , -3.67970891591869 , 3.27798474729977 , 1.41175118838414 , 0.986771734266245 , 0.683986964807003 ",
            " 9.8 , -0.930426272104753 , -0.366479129251928 , 0.393883040751742 , -1.07477618590655 , -2.72866834747517 , 3.29278174922785 , 1.41812391024434 , 0.991226075692495 , 0.687070025319035 ",
            " 9.9 , -0.889191152625361 , -0.457535893775321 , 0.514552908476917 , -1.12461757750004 , -2.18562087391347 , 3.30742852519225 , 1.42443193330356 , 0.99563519459755 , 0.69012356172485 ",
            " 10 , -0.839071529076452 , -0.54402111088937 , 0.648360827459087 , -1.1917935066879 , -1.83816396088967 , 3.32192809488736 , 1.43067655807339 , 1 , 0.693147703147079 ",
        ]
    )
    fun superFunTestMock(
        x: Double,
        cosx: Double,
        sinx: Double,
        tanx: Double,
        secx: Double,
        cscx: Double,
        log_2_x: Double,
        log_5_x: Double,
        log_10_x: Double,
        expected: Double
    ) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(x)).thenReturn(cosx)
        Mockito.`when`(spy.sin(x)).thenReturn(sinx)
        Mockito.`when`(spy.tan(x)).thenReturn(tanx)
        Mockito.`when`(spy.sec(x)).thenReturn(secx)
        Mockito.`when`(spy.csc(x)).thenReturn(cscx)
        Mockito.`when`(spy.log_2(x)).thenReturn(log_2_x)
        Mockito.`when`(spy.log_5(x)).thenReturn(log_5_x)
        Mockito.`when`(spy.log_10(x)).thenReturn(log_10_x)
        Assertions.assertEquals(expected, spy.superFun(x), 0.02 * max(1.0, abs(expected)))
    }

    @ParameterizedTest
    @CsvSource(
        value = [
            " -31.4159265358979 , 1 , 1.22464679914735E-15 , 1.22464679914735E-15 , 1 , 816561967659768 , NaN , NaN , NaN ",
            " -29.845130209103 , -2.93977129859024E-15 , 1 , -340162515526139 , -340162515526139 , 1 , NaN , NaN , NaN ",
            " -28.2743338823081 , -1 , -1.10218211923262E-15 , 1.10218211923262E-15 , -1 , -907291075177520 , NaN , NaN , NaN ",
            " -26.7035375555132 , -7.35407060125E-16 , -1 , 1.35979113367504E+015 , -1.35979113367504E+015 , -1 , NaN , NaN , NaN ",
            " -25.1327412287183 , 1 , 9.79717439317883E-16 , 9.79717439317883E-16 , 1 , 1.02070245957471E+015 , NaN , NaN , NaN ",
            " -23.5619449019234 , -2.69484193876076E-15 , 1 , -371079277643962 , -371079277643962 , 1 , NaN , NaN , NaN ",
            " -21.9911485751286 , -1 , -8.57252759403147E-16 , 8.57252759403147E-16 , -1 , -1.16651709665681E+015 , NaN , NaN , NaN ",
            " -20.4203522483337 , -9.80336419954471E-16 , -1 , 1.02005799197631E+015 , -1.02005799197631E+015 , -1 , NaN , NaN , NaN ",
            " -18.8495559215388 , 1 , 7.34788079488412E-16 , 7.34788079488412E-16 , 1 , 1.36093661276628E+015 , NaN , NaN , NaN ",
            " -17.2787595947439 , -2.44991257893129E-15 , 1 , -408177829935557 , -408177829935557 , 1 , NaN , NaN , NaN ",
            " -15.707963267949 , -1 , -6.12323399573677E-16 , 6.12323399573677E-16 , -1 , -1.63312393531954E+015 , NaN , NaN , NaN ",
            " -14.1371669411541 , 5.51091059616309E-16 , -1 , -1814582150355041 , 1814582150355041 , -1 , NaN , NaN , NaN ",
            " -12.5663706143592 , 1 , 4.89858719658941E-16 , 4.89858719658941E-16 , 1 , 2.04140491914942E+015 , NaN , NaN , NaN ",
            " -10.9955742875643 , -4.28626379701574E-16 , 1 , -2.33303419331362E+015 , -2.33303419331362E+015 , 1 , NaN , NaN , NaN ",
            " -9.42477796076938 , -1 , -3.67394039744206E-16 , 3.67394039744206E-16 , -1 , -2.72187322553256E+015 , NaN , NaN , NaN ",
            " -7.85398163397448 , 3.06161699786838E-16 , -1 , -3266247870639074 , 3.26624787063907E+015 , -1 , NaN , NaN , NaN ",
            " -6.28318530717959 , 1 , 2.44929359829471E-16 , 2.44929359829471E-16 , 1 , 4.08280983829884E+015 , NaN , NaN , NaN ",
            " -4.71238898038469 , -1.83697019872103E-16 , 1 , -5443746451065123 , -5443746451065123 , 1 , NaN , NaN , NaN ",
            " -3.14159265358979 , -1 , -1.22464679914735E-16 , 1.22464679914735E-16 , -1 , -8165619676597685 , NaN , NaN , NaN ",
            " -1.5707963267949 , 6.12323399573677E-17 , -1 , -1.63312393531954E+016 , 1.63312393531954E+016 , -1 , NaN , NaN , NaN ",
        ]
    )
    fun superFunTestInfinityMock(
        x: Double,
        cosx: Double,
        sinx: Double,
        tanx: Double,
        secx: Double,
        cscx: Double,
        log_2_x: Double,
        log_5_x: Double,
        log_10_x: Double
    ) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(x)).thenReturn(cosx)
        Mockito.`when`(spy.sin(x)).thenReturn(sinx)
        Mockito.`when`(spy.tan(x)).thenReturn(tanx)
        Mockito.`when`(spy.sec(x)).thenReturn(secx)
        Mockito.`when`(spy.csc(x)).thenReturn(cscx)
        Mockito.`when`(spy.log_2(x)).thenReturn(log_2_x)
        Mockito.`when`(spy.log_5(x)).thenReturn(log_5_x)
        Mockito.`when`(spy.log_10(x)).thenReturn(log_10_x)
        Assertions.assertTrue(abs(spy.superFun(x)) > 1e10)
    }

    @ParameterizedTest
    @CsvSource(
        value = [
            " 0 , 1 , 0 , 0 , 1 , NaN , NaN , NaN , NaN ",
            " 1 , 0.54030230586814 , 0.841470984807896 , 1.5574077246549 , 1.85081571768093 , 1.18839510577812 , 0 , 0 , 0 ",
        ]
    )
    fun superFunTestNanMock(
        x: Double,
        cosx: Double,
        sinx: Double,
        tanx: Double,
        secx: Double,
        cscx: Double,
        log_2_x: Double,
        log_5_x: Double,
        log_10_x: Double
    ) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(x)).thenReturn(cosx)
        Mockito.`when`(spy.sin(x)).thenReturn(sinx)
        Mockito.`when`(spy.tan(x)).thenReturn(tanx)
        Mockito.`when`(spy.sec(x)).thenReturn(secx)
        Mockito.`when`(spy.csc(x)).thenReturn(cscx)
        Mockito.`when`(spy.log_2(x)).thenReturn(log_2_x)
        Mockito.`when`(spy.log_5(x)).thenReturn(log_5_x)
        Mockito.`when`(spy.log_10(x)).thenReturn(log_10_x)
        Assertions.assertTrue(spy.superFun(x).isNaN())
    }
}
