import org.junit.jupiter.api.Assertions
import org.junit.jupiter.params.ParameterizedTest
import org.junit.jupiter.params.provider.CsvSource
import org.junit.jupiter.params.provider.ValueSource
import org.mockito.Mockito
import kotlin.math.PI
import kotlin.math.abs
import kotlin.math.max

class TrigonometryIntegrationTest {
    @ParameterizedTest
    @CsvSource(
        value = [
            " 0 , 0 ",
            " 0.523598775598299 , 0.5 ",
            " 0.785398163397448 , 0.707106781186547 ",
            " 1.0471975511966 , 0.866025403784439 ",
            " 1.5707963267949 , 1 ",
            " 2.0943951023932 , 0.866025403784439 ",
            " 2.35619449019234 , 0.707106781186548 ",
            " 2.61799387799149 , 0.5 ",
            " 3.14159265358979 , 1.22464679914735E-16 ",
            " 3.66519142918809 , -0.5 ",
            " 3.92699081698724 , -0.707106781186547 ",
            " 4.18879020478639 , -0.866025403784438 ",
            " 4.71238898038469 , -1 ",
            " 5.23598775598299 , -0.866025403784439 ",
            " 5.49778714378214 , -0.707106781186548 ",
            " 5.75958653158129 , -0.5 ",
            " -0.017453292519943 , -0.017452406437284 ",
            " 0.506145483078356 , 0.484809620246337 ",
            " 0.767944870877505 , 0.694658370458997 ",
            " 1.02974425867665 , 0.857167300702112 ",
            " 1.55334303427495 , 0.999847695156391 ",
            " 2.07694180987325 , 0.874619707139396 ",
            " 2.3387411976724 , 0.719339800338651 ",
            " 2.60054058547155 , 0.515038074910054 ",
            " 3.12413936106985 , 0.017452406437284 ",
            " 3.64773813666815 , -0.484809620246337 ",
            " 3.9095375244673 , -0.694658370458997 ",
            " 4.17133691226645 , -0.857167300702112 ",
            " 4.69493568786475 , -0.999847695156391 ",
            " 5.21853446346305 , -0.874619707139396 ",
            " 5.4803338512622 , -0.719339800338651 ",
            " 5.74213323906134 , -0.515038074910054 ",
            " 0.017453292519943 , 0.017452406437284 ",
            " 0.541052068118242 , 0.515038074910054 ",
            " 0.802851455917391 , 0.719339800338651 ",
            " 1.06465084371654 , 0.874619707139396 ",
            " 1.58824961931484 , 0.999847695156391 ",
            " 2.11184839491314 , 0.857167300702112 ",
            " 2.37364778271229 , 0.694658370458997 ",
            " 2.63544717051144 , 0.484809620246337 ",
            " 3.15904594610974 , -0.017452406437283 ",
            " 3.68264472170804 , -0.515038074910054 ",
            " 3.94444410950718 , -0.719339800338651 ",
            " 4.20624349730633 , -0.874619707139395 ",
            " 4.72984227290463 , -0.999847695156391 ",
            " 5.25344104850293 , -0.857167300702112 ",
            " 5.51524043630208 , -0.694658370458998 ",
            " 5.77703982410123 , -0.484809620246338 ",
            " -6.28318530717959 , 2.44929359829471E-16 ",
            " -5.75958653158129 , 0.5 ",
            " -5.49778714378214 , 0.707106781186548 ",
            " -5.23598775598299 , 0.866025403784439 ",
            " -4.71238898038469 , 1 ",
            " -4.18879020478639 , 0.866025403784438 ",
            " -3.92699081698724 , 0.707106781186547 ",
            " -3.66519142918809 , 0.5 ",
            " -3.14159265358979 , -1.22464679914735E-16 ",
            " -2.61799387799149 , -0.5 ",
            " -2.35619449019234 , -0.707106781186548 ",
            " -2.0943951023932 , -0.866025403784439 ",
            " -1.5707963267949 , -1 ",
            " -1.0471975511966 , -0.866025403784439 ",
            " -0.785398163397448 , -0.707106781186547 ",
            " -0.523598775598299 , -0.5 ",
            " -6.30063859969953 , -0.017452406437283 ",
            " -5.77703982410123 , 0.484809620246338 ",
            " -5.51524043630208 , 0.694658370458998 ",
            " -5.25344104850293 , 0.857167300702112 ",
            " -4.72984227290463 , 0.999847695156391 ",
            " -4.20624349730633 , 0.874619707139395 ",
            " -3.94444410950718 , 0.719339800338651 ",
            " -3.68264472170804 , 0.515038074910054 ",
            " -3.15904594610974 , 0.017452406437283 ",
            " -2.63544717051144 , -0.484809620246337 ",
            " -2.37364778271229 , -0.694658370458997 ",
            " -2.11184839491314 , -0.857167300702112 ",
            " -1.58824961931484 , -0.999847695156391 ",
            " -1.06465084371654 , -0.874619707139396 ",
            " -0.802851455917391 , -0.719339800338651 ",
            " -0.541052068118242 , -0.515038074910054 ",
            " -6.26573201465964 , 0.017452406437284 ",
            " -5.74213323906134 , 0.515038074910054 ",
            " -5.4803338512622 , 0.719339800338651 ",
            " -5.21853446346305 , 0.874619707139396 ",
            " -4.69493568786475 , 0.999847695156391 ",
            " -4.17133691226645 , 0.857167300702112 ",
            " -3.9095375244673 , 0.694658370458997 ",
            " -3.64773813666815 , 0.484809620246337 ",
            " -3.12413936106985 , -0.017452406437284 ",
            " -2.60054058547155 , -0.515038074910054 ",
            " -2.3387411976724 , -0.719339800338651 ",
            " -2.07694180987325 , -0.874619707139396 ",
            " -1.55334303427495 , -0.999847695156391 ",
            " -1.02974425867665 , -0.857167300702112 ",
            " -0.767944870877505 , -0.694658370458997 ",
            " -0.506145483078356 , -0.484809620246337 ",
            " 6.28318530717959 , -2.44929359829471E-16 ",
            " 6.80678408277788 , 0.499999999999999 ",
            " 7.06858347057703 , 0.707106781186547 ",
            " 7.33038285837618 , 0.866025403784439 ",
            " 7.85398163397448 , 1 ",
            " 8.37758040957278 , 0.866025403784439 ",
            " 8.63937979737193 , 0.707106781186548 ",
            " 8.90117918517108 , 0.5 ",
            " 9.42477796076938 , 3.67394039744206E-16 ",
            " 9.94837673636768 , -0.499999999999999 ",
            " 10.2101761241668 , -0.707106781186548 ",
            " 10.471975511966 , -0.866025403784439 ",
            " 10.9955742875643 , -1 ",
            " 11.5191730631626 , -0.866025403784439 ",
            " 11.7809724509617 , -0.707106781186548 ",
            " 12.0427718387609 , -0.5 ",
            " 6.26573201465964 , -0.017452406437284 ",
            " 6.78933079025794 , 0.484809620246336 ",
            " 7.05113017805709 , 0.694658370458997 ",
            " 7.31292956585624 , 0.857167300702113 ",
            " 7.83652834145454 , 0.999847695156391 ",
            " 8.36012711705284 , 0.874619707139397 ",
            " 8.62192650485199 , 0.719339800338651 ",
            " 8.88372589265114 , 0.515038074910055 ",
            " 9.40732466824944 , 0.017452406437285 ",
            " 9.93092344384773 , -0.484809620246336 ",
            " 10.1927228316469 , -0.694658370458997 ",
            " 10.454522219446 , -0.857167300702112 ",
            " 10.9781209950443 , -0.999847695156391 ",
            " 11.5017197706426 , -0.874619707139397 ",
            " 11.7635191584418 , -0.719339800338651 ",
            " 12.0253185462409 , -0.515038074910055 ",
            " 6.30063859969953 , 0.017452406437283 ",
            " 6.82423737529783 , 0.515038074910053 ",
            " 7.08603676309698 , 0.719339800338651 ",
            " 7.34783615089613 , 0.874619707139396 ",
            " 7.87143492649443 , 0.999847695156391 ",
            " 8.39503370209273 , 0.857167300702112 ",
            " 8.65683308989187 , 0.694658370458998 ",
            " 8.91863247769103 , 0.484809620246336 ",
            " 9.44223125328932 , -0.017452406437284 ",
            " 9.96583002888762 , -0.515038074910054 ",
            " 10.2276294166868 , -0.719339800338651 ",
            " 10.4894288044859 , -0.874619707139396 ",
            " 11.0130275800842 , -0.999847695156391 ",
            " 11.5366263556825 , -0.857167300702112 ",
            " 11.7984257434817 , -0.694658370458998 ",
            " 12.0602251312808 , -0.484809620246336 ",
        ]
    )
    fun sinTestMock(x: Double, expected: Double) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(Mockito.anyDouble())).thenReturn(expected)
        Assertions.assertEquals(expected, spy.sin(x))
    }

    @ParameterizedTest
    @CsvSource(
        value = [
            " 0 , 1 , 1 ",
            " 0.523598775598299 , 0.866025403784439 , 1.15470053837925 ",
            " 0.785398163397448 , 0.707106781186548 , 1.4142135623731 ",
            " 1.0471975511966 , 0.5 , 2 ",
            " 2.0943951023932 , -0.5 , -2 ",
            " 2.35619449019234 , -0.707106781186547 , -1.4142135623731 ",
            " 2.61799387799149 , -0.866025403784439 , -1.15470053837925 ",
            " 3.14159265358979 , -1 , -1 ",
            " 3.66519142918809 , -0.866025403784439 , -1.15470053837925 ",
            " 3.92699081698724 , -0.707106781186548 , -1.41421356237309 ",
            " 4.18879020478639 , -0.5 , -2 ",
            " 4.71238898038469 , -1.83697019872103E-16 , -5443746451065123 ",
            " 5.23598775598299 , 0.5 , 2 ",
            " 5.49778714378214 , 0.707106781186547 , 1.4142135623731 ",
            " 5.75958653158129 , 0.866025403784438 , 1.15470053837925 ",
            " -0.017453292519943 , 0.999847695156391 , 1.00015232804391 ",
            " 0.506145483078356 , 0.874619707139396 , 1.14335406787332 ",
            " 0.767944870877505 , 0.719339800338651 , 1.39016359101668 ",
            " 1.02974425867665 , 0.515038074910054 , 1.94160402641036 ",
            " 1.55334303427495 , 0.017452406437284 , 57.2986884985499 ",
            " 2.07694180987325 , -0.484809620246337 , -2.06266533962731 ",
            " 2.3387411976724 , -0.694658370458997 , -1.43955653962573 ",
            " 2.60054058547155 , -0.857167300702112 , -1.16663339721533 ",
            " 3.12413936106985 , -0.999847695156391 , -1.00015232804391 ",
            " 3.64773813666815 , -0.874619707139396 , -1.14335406787332 ",
            " 3.9095375244673 , -0.719339800338651 , -1.39016359101668 ",
            " 4.17133691226645 , -0.515038074910054 , -1.94160402641036 ",
            " 4.69493568786475 , -0.017452406437284 , -57.2986884985502 ",
            " 5.21853446346305 , 0.484809620246337 , 2.06266533962731 ",
            " 5.4803338512622 , 0.694658370458997 , 1.43955653962573 ",
            " 5.74213323906134 , 0.857167300702112 , 1.16663339721533 ",
            " 0.017453292519943 , 0.999847695156391 , 1.00015232804391 ",
            " 0.541052068118242 , 0.857167300702112 , 1.16663339721533 ",
            " 0.802851455917391 , 0.694658370458997 , 1.43955653962573 ",
            " 1.06465084371654 , 0.484809620246337 , 2.06266533962731 ",
            " 1.58824961931484 , -0.017452406437284 , -57.2986884985503 ",
            " 2.11184839491314 , -0.515038074910054 , -1.94160402641036 ",
            " 2.37364778271229 , -0.719339800338651 , -1.39016359101668 ",
            " 2.63544717051144 , -0.874619707139396 , -1.14335406787332 ",
            " 3.15904594610974 , -0.999847695156391 , -1.00015232804391 ",
            " 3.68264472170804 , -0.857167300702112 , -1.16663339721533 ",
            " 3.94444410950718 , -0.694658370458998 , -1.43955653962573 ",
            " 4.20624349730633 , -0.484809620246338 , -2.06266533962731 ",
            " 4.72984227290463 , 0.017452406437283 , 57.2986884985514 ",
            " 5.25344104850293 , 0.515038074910054 , 1.94160402641036 ",
            " 5.51524043630208 , 0.719339800338651 , 1.39016359101668 ",
            " 5.77703982410123 , 0.874619707139395 , 1.14335406787332 ",
            " -6.28318530717959 , 1 , 1 ",
            " -5.75958653158129 , 0.866025403784438 , 1.15470053837925 ",
            " -5.49778714378214 , 0.707106781186547 , 1.4142135623731 ",
            " -5.23598775598299 , 0.5 , 2 ",
            " -4.71238898038469 , -1.83697019872103E-16 , -5443746451065123 ",
            " -4.18879020478639 , -0.5 , -2 ",
            " -3.92699081698724 , -0.707106781186548 , -1.41421356237309 ",
            " -3.66519142918809 , -0.866025403784439 , -1.15470053837925 ",
            " -3.14159265358979 , -1 , -1 ",
            " -2.61799387799149 , -0.866025403784439 , -1.15470053837925 ",
            " -2.35619449019234 , -0.707106781186547 , -1.4142135623731 ",
            " -2.0943951023932 , -0.5 , -2 ",
            " -1.0471975511966 , 0.5 , 2 ",
            " -0.785398163397448 , 0.707106781186548 , 1.4142135623731 ",
            " -0.523598775598299 , 0.866025403784439 , 1.15470053837925 ",
            " -6.30063859969953 , 0.999847695156391 , 1.00015232804391 ",
            " -5.77703982410123 , 0.874619707139395 , 1.14335406787332 ",
            " -5.51524043630208 , 0.719339800338651 , 1.39016359101668 ",
            " -5.25344104850293 , 0.515038074910054 , 1.94160402641036 ",
            " -4.72984227290463 , 0.017452406437283 , 57.2986884985514 ",
            " -4.20624349730633 , -0.484809620246338 , -2.06266533962731 ",
            " -3.94444410950718 , -0.694658370458998 , -1.43955653962573 ",
            " -3.68264472170804 , -0.857167300702112 , -1.16663339721533 ",
            " -3.15904594610974 , -0.999847695156391 , -1.00015232804391 ",
            " -2.63544717051144 , -0.874619707139396 , -1.14335406787332 ",
            " -2.37364778271229 , -0.719339800338651 , -1.39016359101668 ",
            " -2.11184839491314 , -0.515038074910054 , -1.94160402641036 ",
            " -1.58824961931484 , -0.017452406437284 , -57.2986884985503 ",
            " -1.06465084371654 , 0.484809620246337 , 2.06266533962731 ",
            " -0.802851455917391 , 0.694658370458997 , 1.43955653962573 ",
            " -0.541052068118242 , 0.857167300702112 , 1.16663339721533 ",
            " -6.26573201465964 , 0.999847695156391 , 1.00015232804391 ",
            " -5.74213323906134 , 0.857167300702112 , 1.16663339721533 ",
            " -5.4803338512622 , 0.694658370458997 , 1.43955653962573 ",
            " -5.21853446346305 , 0.484809620246337 , 2.06266533962731 ",
            " -4.69493568786475 , -0.017452406437284 , -57.2986884985502 ",
            " -4.17133691226645 , -0.515038074910054 , -1.94160402641036 ",
            " -3.9095375244673 , -0.719339800338651 , -1.39016359101668 ",
            " -3.64773813666815 , -0.874619707139396 , -1.14335406787332 ",
            " -3.12413936106985 , -0.999847695156391 , -1.00015232804391 ",
            " -2.60054058547155 , -0.857167300702112 , -1.16663339721533 ",
            " -2.3387411976724 , -0.694658370458997 , -1.43955653962573 ",
            " -2.07694180987325 , -0.484809620246337 , -2.06266533962731 ",
            " -1.55334303427495 , 0.017452406437284 , 57.2986884985499 ",
            " -1.02974425867665 , 0.515038074910054 , 1.94160402641036 ",
            " -0.767944870877505 , 0.719339800338651 , 1.39016359101668 ",
            " -0.506145483078356 , 0.874619707139396 , 1.14335406787332 ",
            " 6.28318530717959 , 1 , 1 ",
            " 6.80678408277788 , 0.866025403784439 , 1.15470053837925 ",
            " 7.06858347057703 , 0.707106781186548 , 1.41421356237309 ",
            " 7.33038285837618 , 0.5 , 2 ",
            " 8.37758040957278 , -0.499999999999999 , -2 ",
            " 8.63937979737193 , -0.707106781186547 , -1.4142135623731 ",
            " 8.90117918517108 , -0.866025403784439 , -1.15470053837925 ",
            " 9.42477796076938 , -1 , -1 ",
            " 9.94837673636768 , -0.866025403784439 , -1.15470053837925 ",
            " 10.2101761241668 , -0.707106781186547 , -1.4142135623731 ",
            " 10.471975511966 , -0.5 , -2 ",
            " 11.5191730631626 , 0.499999999999999 , 2 ",
            " 11.7809724509617 , 0.707106781186547 , 1.4142135623731 ",
            " 12.0427718387609 , 0.866025403784439 , 1.15470053837925 ",
            " 6.26573201465964 , 0.999847695156391 , 1.00015232804391 ",
            " 6.78933079025794 , 0.874619707139396 , 1.14335406787332 ",
            " 7.05113017805709 , 0.719339800338651 , 1.39016359101668 ",
            " 7.31292956585624 , 0.515038074910054 , 1.94160402641036 ",
            " 7.83652834145454 , 0.017452406437284 , 57.2986884985498 ",
            " 8.36012711705284 , -0.484809620246336 , -2.06266533962732 ",
            " 8.62192650485199 , -0.694658370458997 , -1.43955653962573 ",
            " 8.88372589265114 , -0.857167300702112 , -1.16663339721533 ",
            " 9.40732466824944 , -0.999847695156391 , -1.00015232804391 ",
            " 9.93092344384773 , -0.874619707139397 , -1.14335406787332 ",
            " 10.1927228316469 , -0.719339800338651 , -1.39016359101668 ",
            " 10.454522219446 , -0.515038074910055 , -1.94160402641036 ",
            " 10.9781209950443 , -0.017452406437285 , -57.2986884985465 ",
            " 11.5017197706426 , 0.484809620246335 , 2.06266533962732 ",
            " 11.7635191584418 , 0.694658370458997 , 1.43955653962573 ",
            " 12.0253185462409 , 0.857167300702112 , 1.16663339721533 ",
            " 6.30063859969953 , 0.999847695156391 , 1.00015232804391 ",
            " 6.82423737529783 , 0.857167300702113 , 1.16663339721533 ",
            " 7.08603676309698 , 0.694658370458998 , 1.43955653962573 ",
            " 7.34783615089613 , 0.484809620246337 , 2.06266533962731 ",
            " 7.87143492649443 , -0.017452406437283 , -57.2986884985518 ",
            " 8.39503370209273 , -0.515038074910054 , -1.94160402641036 ",
            " 8.65683308989187 , -0.719339800338651 , -1.39016359101668 ",
            " 8.91863247769103 , -0.874619707139396 , -1.14335406787332 ",
            " 9.44223125328932 , -0.999847695156391 , -1.00015232804391 ",
            " 9.96583002888762 , -0.857167300702112 , -1.16663339721533 ",
            " 10.2276294166868 , -0.694658370458998 , -1.43955653962573 ",
            " 10.4894288044859 , -0.484809620246336 , -2.06266533962732 ",
            " 11.0130275800842 , 0.017452406437284 , 57.2986884985493 ",
            " 11.5366263556825 , 0.515038074910054 , 1.94160402641036 ",
            " 11.7984257434817 , 0.719339800338651 , 1.39016359101668 ",
            " 12.0602251312808 , 0.874619707139396 , 1.14335406787332 ",
        ]
    )
    fun secTestMock(x: Double, cosValue: Double, expected: Double) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(x)).thenReturn(cosValue)
        Assertions.assertEquals(expected, spy.sec(x), 0.02 * max(1.0, abs(expected)))
    }

    @ParameterizedTest
    @ValueSource(
        doubles = [
            1.5707963267949,
            -1.5707963267949,
            7.85398163397448,
            10.9955742875643,
        ]
    )
    fun secTestInfinityMock(x: Double) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(x)).thenReturn(0.0)
        Assertions.assertTrue(abs(spy.sec(x)) > 1e10)
    }

    @ParameterizedTest
    @CsvSource(
        value = [
            " 0.523598775598299 , 0.5 , 2 ",
            " 0.785398163397448 , 0.707106781186547 , 1.4142135623731 ",
            " 1.0471975511966 , 0.866025403784439 , 1.15470053837925 ",
            " 1.5707963267949 , 1 , 1 ",
            " 2.0943951023932 , 0.866025403784439 , 1.15470053837925 ",
            " 2.35619449019234 , 0.707106781186548 , 1.4142135623731 ",
            " 2.61799387799149 , 0.5 , 2 ",
            " 3.66519142918809 , -0.5 , -2 ",
            " 3.92699081698724 , -0.707106781186547 , -1.4142135623731 ",
            " 4.18879020478639 , -0.866025403784438 , -1.15470053837925 ",
            " 4.71238898038469 , -1 , -1 ",
            " 5.23598775598299 , -0.866025403784439 , -1.15470053837925 ",
            " 5.49778714378214 , -0.707106781186548 , -1.41421356237309 ",
            " 5.75958653158129 , -0.5 , -2 ",
            " -0.017453292519943 , -0.017452406437284 , -57.2986884985502 ",
            " 0.506145483078356 , 0.484809620246337 , 2.06266533962731 ",
            " 0.767944870877505 , 0.694658370458997 , 1.43955653962573 ",
            " 1.02974425867665 , 0.857167300702112 , 1.16663339721533 ",
            " 1.55334303427495 , 0.999847695156391 , 1.00015232804391 ",
            " 2.07694180987325 , 0.874619707139396 , 1.14335406787332 ",
            " 2.3387411976724 , 0.719339800338651 , 1.39016359101668 ",
            " 2.60054058547155 , 0.515038074910054 , 1.94160402641036 ",
            " 3.12413936106985 , 0.017452406437284 , 57.2986884985504 ",
            " 3.64773813666815 , -0.484809620246337 , -2.06266533962731 ",
            " 3.9095375244673 , -0.694658370458997 , -1.43955653962573 ",
            " 4.17133691226645 , -0.857167300702112 , -1.16663339721533 ",
            " 4.69493568786475 , -0.999847695156391 , -1.00015232804391 ",
            " 5.21853446346305 , -0.874619707139396 , -1.14335406787332 ",
            " 5.4803338512622 , -0.719339800338651 , -1.39016359101668 ",
            " 5.74213323906134 , -0.515038074910054 , -1.94160402641036 ",
            " 0.017453292519943 , 0.017452406437284 , 57.2986884985502 ",
            " 0.541052068118242 , 0.515038074910054 , 1.94160402641036 ",
            " 0.802851455917391 , 0.719339800338651 , 1.39016359101668 ",
            " 1.06465084371654 , 0.874619707139396 , 1.14335406787332 ",
            " 1.58824961931484 , 0.999847695156391 , 1.00015232804391 ",
            " 2.11184839491314 , 0.857167300702112 , 1.16663339721533 ",
            " 2.37364778271229 , 0.694658370458997 , 1.43955653962573 ",
            " 2.63544717051144 , 0.484809620246337 , 2.06266533962731 ",
            " 3.15904594610974 , -0.017452406437283 , -57.2986884985512 ",
            " 3.68264472170804 , -0.515038074910054 , -1.94160402641036 ",
            " 3.94444410950718 , -0.719339800338651 , -1.39016359101668 ",
            " 4.20624349730633 , -0.874619707139395 , -1.14335406787332 ",
            " 4.72984227290463 , -0.999847695156391 , -1.00015232804391 ",
            " 5.25344104850293 , -0.857167300702112 , -1.16663339721533 ",
            " 5.51524043630208 , -0.694658370458998 , -1.43955653962573 ",
            " 5.77703982410123 , -0.484809620246338 , -2.06266533962731 ",
            " -5.75958653158129 , 0.5 , 2 ",
            " -5.49778714378214 , 0.707106781186548 , 1.41421356237309 ",
            " -5.23598775598299 , 0.866025403784439 , 1.15470053837925 ",
            " -4.71238898038469 , 1 , 1 ",
            " -4.18879020478639 , 0.866025403784438 , 1.15470053837925 ",
            " -3.92699081698724 , 0.707106781186547 , 1.4142135623731 ",
            " -3.66519142918809 , 0.5 , 2 ",
            " -2.61799387799149 , -0.5 , -2 ",
            " -2.35619449019234 , -0.707106781186548 , -1.4142135623731 ",
            " -2.0943951023932 , -0.866025403784439 , -1.15470053837925 ",
            " -1.5707963267949 , -1 , -1 ",
            " -1.0471975511966 , -0.866025403784439 , -1.15470053837925 ",
            " -0.785398163397448 , -0.707106781186547 , -1.4142135623731 ",
            " -0.523598775598299 , -0.5 , -2 ",
            " -6.30063859969953 , -0.017452406437283 , -57.2986884985516 ",
            " -5.77703982410123 , 0.484809620246338 , 2.06266533962731 ",
            " -5.51524043630208 , 0.694658370458998 , 1.43955653962573 ",
            " -5.25344104850293 , 0.857167300702112 , 1.16663339721533 ",
            " -4.72984227290463 , 0.999847695156391 , 1.00015232804391 ",
            " -4.20624349730633 , 0.874619707139395 , 1.14335406787332 ",
            " -3.94444410950718 , 0.719339800338651 , 1.39016359101668 ",
            " -3.68264472170804 , 0.515038074910054 , 1.94160402641036 ",
            " -3.15904594610974 , 0.017452406437283 , 57.2986884985512 ",
            " -2.63544717051144 , -0.484809620246337 , -2.06266533962731 ",
            " -2.37364778271229 , -0.694658370458997 , -1.43955653962573 ",
            " -2.11184839491314 , -0.857167300702112 , -1.16663339721533 ",
            " -1.58824961931484 , -0.999847695156391 , -1.00015232804391 ",
            " -1.06465084371654 , -0.874619707139396 , -1.14335406787332 ",
            " -0.802851455917391 , -0.719339800338651 , -1.39016359101668 ",
            " -0.541052068118242 , -0.515038074910054 , -1.94160402641036 ",
            " -6.26573201465964 , 0.017452406437284 , 57.29868849855 ",
            " -5.74213323906134 , 0.515038074910054 , 1.94160402641036 ",
            " -5.4803338512622 , 0.719339800338651 , 1.39016359101668 ",
            " -5.21853446346305 , 0.874619707139396 , 1.14335406787332 ",
            " -4.69493568786475 , 0.999847695156391 , 1.00015232804391 ",
            " -4.17133691226645 , 0.857167300702112 , 1.16663339721533 ",
            " -3.9095375244673 , 0.694658370458997 , 1.43955653962573 ",
            " -3.64773813666815 , 0.484809620246337 , 2.06266533962731 ",
            " -3.12413936106985 , -0.017452406437284 , -57.2986884985504 ",
            " -2.60054058547155 , -0.515038074910054 , -1.94160402641036 ",
            " -2.3387411976724 , -0.719339800338651 , -1.39016359101668 ",
            " -2.07694180987325 , -0.874619707139396 , -1.14335406787332 ",
            " -1.55334303427495 , -0.999847695156391 , -1.00015232804391 ",
            " -1.02974425867665 , -0.857167300702112 , -1.16663339721533 ",
            " -0.767944870877505 , -0.694658370458997 , -1.43955653962573 ",
            " -0.506145483078356 , -0.484809620246337 , -2.06266533962731 ",
            " 6.80678408277788 , 0.499999999999999 , 2 ",
            " 7.06858347057703 , 0.707106781186547 , 1.4142135623731 ",
            " 7.33038285837618 , 0.866025403784439 , 1.15470053837925 ",
            " 7.85398163397448 , 1 , 1 ",
            " 8.37758040957278 , 0.866025403784439 , 1.15470053837925 ",
            " 8.63937979737193 , 0.707106781186548 , 1.41421356237309 ",
            " 8.90117918517108 , 0.5 , 2 ",
            " 9.94837673636768 , -0.499999999999999 , -2 ",
            " 10.2101761241668 , -0.707106781186548 , -1.41421356237309 ",
            " 10.471975511966 , -0.866025403784439 , -1.15470053837925 ",
            " 10.9955742875643 , -1 , -1 ",
            " 11.5191730631626 , -0.866025403784439 , -1.15470053837925 ",
            " 11.7809724509617 , -0.707106781186548 , -1.41421356237309 ",
            " 12.0427718387609 , -0.5 , -2 ",
            " 6.26573201465964 , -0.017452406437284 , -57.29868849855 ",
            " 6.78933079025794 , 0.484809620246336 , 2.06266533962732 ",
            " 7.05113017805709 , 0.694658370458997 , 1.43955653962573 ",
            " 7.31292956585624 , 0.857167300702113 , 1.16663339721533 ",
            " 7.83652834145454 , 0.999847695156391 , 1.00015232804391 ",
            " 8.36012711705284 , 0.874619707139397 , 1.14335406787332 ",
            " 8.62192650485199 , 0.719339800338651 , 1.39016359101668 ",
            " 8.88372589265114 , 0.515038074910055 , 1.94160402641036 ",
            " 9.40732466824944 , 0.017452406437285 , 57.2986884985467 ",
            " 9.93092344384773 , -0.484809620246336 , -2.06266533962732 ",
            " 10.1927228316469 , -0.694658370458997 , -1.43955653962573 ",
            " 10.454522219446 , -0.857167300702112 , -1.16663339721533 ",
            " 10.9781209950443 , -0.999847695156391 , -1.00015232804391 ",
            " 11.5017197706426 , -0.874619707139397 , -1.14335406787332 ",
            " 11.7635191584418 , -0.719339800338651 , -1.39016359101668 ",
            " 12.0253185462409 , -0.515038074910055 , -1.94160402641035 ",
            " 6.30063859969953 , 0.017452406437283 , 57.2986884985516 ",
            " 6.82423737529783 , 0.515038074910053 , 1.94160402641036 ",
            " 7.08603676309698 , 0.719339800338651 , 1.39016359101668 ",
            " 7.34783615089613 , 0.874619707139396 , 1.14335406787332 ",
            " 7.87143492649443 , 0.999847695156391 , 1.00015232804391 ",
            " 8.39503370209273 , 0.857167300702112 , 1.16663339721533 ",
            " 8.65683308989187 , 0.694658370458998 , 1.43955653962573 ",
            " 8.91863247769103 , 0.484809620246336 , 2.06266533962732 ",
            " 9.44223125328932 , -0.017452406437284 , -57.2986884985491 ",
            " 9.96583002888762 , -0.515038074910054 , -1.94160402641036 ",
            " 10.2276294166868 , -0.719339800338651 , -1.39016359101668 ",
            " 10.4894288044859 , -0.874619707139396 , -1.14335406787332 ",
            " 11.0130275800842 , -0.999847695156391 , -1.00015232804391 ",
            " 11.5366263556825 , -0.857167300702112 , -1.16663339721533 ",
            " 11.7984257434817 , -0.694658370458998 , -1.43955653962573 ",
            " 12.0602251312808 , -0.484809620246336 , -2.06266533962732 ",
        ]
    )
    fun cscTestMock(x: Double, sinValue: Double, expected: Double) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.sin(x)).thenReturn(sinValue)
        Assertions.assertEquals(expected, spy.csc(x), 0.02 * max(1.0, abs(expected)))
    }

    @ParameterizedTest
    @ValueSource(
        doubles = [
            0.0,
            3.14159265358979,
            -6.28318530717959,
            -3.14159265358979,
            6.28318530717959,
            9.42477796076938,
        ]
    )
    fun cscTestInfinityMock(x: Double) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(x)).thenReturn(0.0)
        Assertions.assertTrue(abs(spy.sec(x)) > 1e10)
    }

    @ParameterizedTest
    @CsvSource(
        value = [
            " 0 , 1 , 0 , 0 ",
            " 0.523598775598299 , 0.866025403784439 , 0.5 , 0.577350269189626 ",
            " 0.785398163397448 , 0.707106781186548 , 0.707106781186547 , 1 ",
            " 1.0471975511966 , 0.5 , 0.866025403784439 , 1.73205080756888 ",
            " 2.0943951023932 , -0.5 , 0.866025403784439 , -1.73205080756888 ",
            " 2.35619449019234 , -0.707106781186547 , 0.707106781186548 , -1 ",
            " 2.61799387799149 , -0.866025403784439 , 0.5 , -0.577350269189626 ",
            " 3.14159265358979 , -1 , 1.22464679914735E-16 , -1.22464679914735E-16 ",
            " 3.66519142918809 , -0.866025403784439 , -0.5 , 0.577350269189626 ",
            " 3.92699081698724 , -0.707106781186548 , -0.707106781186547 , 1 ",
            " 4.18879020478639 , -0.5 , -0.866025403784438 , 1.73205080756888 ",
            " 5.23598775598299 , 0.5 , -0.866025403784439 , -1.73205080756888 ",
            " 5.49778714378214 , 0.707106781186547 , -0.707106781186548 , -1 ",
            " 5.75958653158129 , 0.866025403784438 , -0.5 , -0.577350269189626 ",
            " -0.017453292519943 , 0.999847695156391 , -0.017452406437284 , -0.017455064928218 ",
            " 0.506145483078356 , 0.874619707139396 , 0.484809620246337 , 0.554309051452769 ",
            " 0.767944870877505 , 0.719339800338651 , 0.694658370458997 , 0.965688774807074 ",
            " 1.02974425867665 , 0.515038074910054 , 0.857167300702112 , 1.66427948235052 ",
            " 1.55334303427495 , 0.017452406437284 , 0.999847695156391 , 57.2899616307591 ",
            " 2.07694180987325 , -0.484809620246337 , 0.874619707139396 , -1.80404775527142 ",
            " 2.3387411976724 , -0.694658370458997 , 0.719339800338651 , -1.03553031379057 ",
            " 2.60054058547155 , -0.857167300702112 , 0.515038074910054 , -0.600860619027561 ",
            " 3.12413936106985 , -0.999847695156391 , 0.017452406437284 , -0.017455064928218 ",
            " 3.64773813666815 , -0.874619707139396 , -0.484809620246337 , 0.554309051452769 ",
            " 3.9095375244673 , -0.719339800338651 , -0.694658370458997 , 0.965688774807074 ",
            " 4.17133691226645 , -0.515038074910054 , -0.857167300702112 , 1.66427948235052 ",
            " 4.69493568786475 , -0.017452406437284 , -0.999847695156391 , 57.2899616307595 ",
            " 5.21853446346305 , 0.484809620246337 , -0.874619707139396 , -1.80404775527142 ",
            " 5.4803338512622 , 0.694658370458997 , -0.719339800338651 , -1.03553031379057 ",
            " 5.74213323906134 , 0.857167300702112 , -0.515038074910054 , -0.600860619027561 ",
            " 0.017453292519943 , 0.999847695156391 , 0.017452406437284 , 0.017455064928218 ",
            " 0.541052068118242 , 0.857167300702112 , 0.515038074910054 , 0.60086061902756 ",
            " 0.802851455917391 , 0.694658370458997 , 0.719339800338651 , 1.03553031379057 ",
            " 1.06465084371654 , 0.484809620246337 , 0.874619707139396 , 1.80404775527142 ",
            " 1.58824961931484 , -0.017452406437284 , 0.999847695156391 , -57.2899616307596 ",
            " 2.11184839491314 , -0.515038074910054 , 0.857167300702112 , -1.66427948235052 ",
            " 2.37364778271229 , -0.719339800338651 , 0.694658370458997 , -0.965688774807075 ",
            " 2.63544717051144 , -0.874619707139396 , 0.484809620246337 , -0.554309051452769 ",
            " 3.15904594610974 , -0.999847695156391 , -0.017452406437283 , 0.017455064928217 ",
            " 3.68264472170804 , -0.857167300702112 , -0.515038074910054 , 0.60086061902756 ",
            " 3.94444410950718 , -0.694658370458998 , -0.719339800338651 , 1.03553031379057 ",
            " 4.20624349730633 , -0.484809620246338 , -0.874619707139395 , 1.80404775527142 ",
            " 4.72984227290463 , 0.017452406437283 , -0.999847695156391 , -57.2899616307607 ",
            " 5.25344104850293 , 0.515038074910054 , -0.857167300702112 , -1.66427948235052 ",
            " 5.51524043630208 , 0.719339800338651 , -0.694658370458998 , -0.965688774807075 ",
            " 5.77703982410123 , 0.874619707139395 , -0.484809620246338 , -0.55430905145277 ",
            " -6.28318530717959 , 1 , 2.44929359829471E-16 , 2.44929359829471E-16 ",
            " -5.75958653158129 , 0.866025403784438 , 0.5 , 0.577350269189626 ",
            " -5.49778714378214 , 0.707106781186547 , 0.707106781186548 , 1 ",
            " -5.23598775598299 , 0.5 , 0.866025403784439 , 1.73205080756888 ",
            " -4.18879020478639 , -0.5 , 0.866025403784438 , -1.73205080756888 ",
            " -3.92699081698724 , -0.707106781186548 , 0.707106781186547 , -1 ",
            " -3.66519142918809 , -0.866025403784439 , 0.5 , -0.577350269189626 ",
            " -3.14159265358979 , -1 , -1.22464679914735E-16 , 1.22464679914735E-16 ",
            " -2.61799387799149 , -0.866025403784439 , -0.5 , 0.577350269189626 ",
            " -2.35619449019234 , -0.707106781186547 , -0.707106781186548 , 1 ",
            " -2.0943951023932 , -0.5 , -0.866025403784439 , 1.73205080756888 ",
            " -1.0471975511966 , 0.5 , -0.866025403784439 , -1.73205080756888 ",
            " -0.785398163397448 , 0.707106781186548 , -0.707106781186547 , -1 ",
            " -0.523598775598299 , 0.866025403784439 , -0.5 , -0.577350269189626 ",
            " -6.30063859969953 , 0.999847695156391 , -0.017452406437283 , -0.017455064928217 ",
            " -5.77703982410123 , 0.874619707139395 , 0.484809620246338 , 0.55430905145277 ",
            " -5.51524043630208 , 0.719339800338651 , 0.694658370458998 , 0.965688774807075 ",
            " -5.25344104850293 , 0.515038074910054 , 0.857167300702112 , 1.66427948235052 ",
            " -4.72984227290463 , 0.017452406437283 , 0.999847695156391 , 57.2899616307607 ",
            " -4.20624349730633 , -0.484809620246338 , 0.874619707139395 , -1.80404775527142 ",
            " -3.94444410950718 , -0.694658370458998 , 0.719339800338651 , -1.03553031379057 ",
            " -3.68264472170804 , -0.857167300702112 , 0.515038074910054 , -0.60086061902756 ",
            " -3.15904594610974 , -0.999847695156391 , 0.017452406437283 , -0.017455064928217 ",
            " -2.63544717051144 , -0.874619707139396 , -0.484809620246337 , 0.554309051452769 ",
            " -2.37364778271229 , -0.719339800338651 , -0.694658370458997 , 0.965688774807075 ",
            " -2.11184839491314 , -0.515038074910054 , -0.857167300702112 , 1.66427948235052 ",
            " -1.58824961931484 , -0.017452406437284 , -0.999847695156391 , 57.2899616307596 ",
            " -1.06465084371654 , 0.484809620246337 , -0.874619707139396 , -1.80404775527142 ",
            " -0.802851455917391 , 0.694658370458997 , -0.719339800338651 , -1.03553031379057 ",
            " -0.541052068118242 , 0.857167300702112 , -0.515038074910054 , -0.60086061902756 ",
            " -6.26573201465964 , 0.999847695156391 , 0.017452406437284 , 0.017455064928218 ",
            " -5.74213323906134 , 0.857167300702112 , 0.515038074910054 , 0.600860619027561 ",
            " -5.4803338512622 , 0.694658370458997 , 0.719339800338651 , 1.03553031379057 ",
            " -5.21853446346305 , 0.484809620246337 , 0.874619707139396 , 1.80404775527142 ",
            " -4.69493568786475 , -0.017452406437284 , 0.999847695156391 , -57.2899616307595 ",
            " -4.17133691226645 , -0.515038074910054 , 0.857167300702112 , -1.66427948235052 ",
            " -3.9095375244673 , -0.719339800338651 , 0.694658370458997 , -0.965688774807074 ",
            " -3.64773813666815 , -0.874619707139396 , 0.484809620246337 , -0.554309051452769 ",
            " -3.12413936106985 , -0.999847695156391 , -0.017452406437284 , 0.017455064928218 ",
            " -2.60054058547155 , -0.857167300702112 , -0.515038074910054 , 0.600860619027561 ",
            " -2.3387411976724 , -0.694658370458997 , -0.719339800338651 , 1.03553031379057 ",
            " -2.07694180987325 , -0.484809620246337 , -0.874619707139396 , 1.80404775527142 ",
            " -1.55334303427495 , 0.017452406437284 , -0.999847695156391 , -57.2899616307591 ",
            " -1.02974425867665 , 0.515038074910054 , -0.857167300702112 , -1.66427948235052 ",
            " -0.767944870877505 , 0.719339800338651 , -0.694658370458997 , -0.965688774807074 ",
            " -0.506145483078356 , 0.874619707139396 , -0.484809620246337 , -0.554309051452769 ",
            " 6.28318530717959 , 1 , -2.44929359829471E-16 , -2.44929359829471E-16 ",
            " 6.80678408277788 , 0.866025403784439 , 0.499999999999999 , 0.577350269189625 ",
            " 7.06858347057703 , 0.707106781186548 , 0.707106781186547 , 1 ",
            " 7.33038285837618 , 0.5 , 0.866025403784439 , 1.73205080756888 ",
            " 8.37758040957278 , -0.499999999999999 , 0.866025403784439 , -1.73205080756888 ",
            " 8.63937979737193 , -0.707106781186547 , 0.707106781186548 , -1 ",
            " 8.90117918517108 , -0.866025403784439 , 0.5 , -0.577350269189625 ",
            " 9.42477796076938 , -1 , 3.67394039744206E-16 , -3.67394039744206E-16 ",
            " 9.94837673636768 , -0.866025403784439 , -0.499999999999999 , 0.577350269189625 ",
            " 10.2101761241668 , -0.707106781186547 , -0.707106781186548 , 1 ",
            " 10.471975511966 , -0.5 , -0.866025403784439 , 1.73205080756888 ",
            " 11.5191730631626 , 0.499999999999999 , -0.866025403784439 , -1.73205080756888 ",
            " 11.7809724509617 , 0.707106781186547 , -0.707106781186548 , -1 ",
            " 12.0427718387609 , 0.866025403784439 , -0.5 , -0.577350269189626 ",
            " 6.26573201465964 , 0.999847695156391 , -0.017452406437284 , -0.017455064928218 ",
            " 6.78933079025794 , 0.874619707139396 , 0.484809620246336 , 0.554309051452768 ",
            " 7.05113017805709 , 0.719339800338651 , 0.694658370458997 , 0.965688774807074 ",
            " 7.31292956585624 , 0.515038074910054 , 0.857167300702113 , 1.66427948235052 ",
            " 7.83652834145454 , 0.017452406437284 , 0.999847695156391 , 57.2899616307591 ",
            " 8.36012711705284 , -0.484809620246336 , 0.874619707139397 , -1.80404775527143 ",
            " 8.62192650485199 , -0.694658370458997 , 0.719339800338651 , -1.03553031379057 ",
            " 8.88372589265114 , -0.857167300702112 , 0.515038074910055 , -0.600860619027561 ",
            " 9.40732466824944 , -0.999847695156391 , 0.017452406437285 , -0.017455064928219 ",
            " 9.93092344384773 , -0.874619707139397 , -0.484809620246336 , 0.554309051452767 ",
            " 10.1927228316469 , -0.719339800338651 , -0.694658370458997 , 0.965688774807074 ",
            " 10.454522219446 , -0.515038074910055 , -0.857167300702112 , 1.66427948235052 ",
            " 10.9781209950443 , -0.017452406437285 , -0.999847695156391 , 57.2899616307558 ",
            " 11.5017197706426 , 0.484809620246335 , -0.874619707139397 , -1.80404775527143 ",
            " 11.7635191584418 , 0.694658370458997 , -0.719339800338651 , -1.03553031379057 ",
            " 12.0253185462409 , 0.857167300702112 , -0.515038074910055 , -0.600860619027561 ",
            " 6.30063859969953 , 0.999847695156391 , 0.017452406437283 , 0.017455064928217 ",
            " 6.82423737529783 , 0.857167300702113 , 0.515038074910053 , 0.600860619027559 ",
            " 7.08603676309698 , 0.694658370458998 , 0.719339800338651 , 1.03553031379057 ",
            " 7.34783615089613 , 0.484809620246337 , 0.874619707139396 , 1.80404775527142 ",
            " 7.87143492649443 , -0.017452406437283 , 0.999847695156391 , -57.2899616307611 ",
            " 8.39503370209273 , -0.515038074910054 , 0.857167300702112 , -1.66427948235052 ",
            " 8.65683308989187 , -0.719339800338651 , 0.694658370458998 , -0.965688774807075 ",
            " 8.91863247769103 , -0.874619707139396 , 0.484809620246336 , -0.554309051452768 ",
            " 9.44223125328932 , -0.999847695156391 , -0.017452406437284 , 0.017455064928218 ",
            " 9.96583002888762 , -0.857167300702112 , -0.515038074910054 , 0.60086061902756 ",
            " 10.2276294166868 , -0.694658370458998 , -0.719339800338651 , 1.03553031379057 ",
            " 10.4894288044859 , -0.484809620246336 , -0.874619707139396 , 1.80404775527143 ",
            " 11.0130275800842 , 0.017452406437284 , -0.999847695156391 , -57.2899616307586 ",
            " 11.5366263556825 , 0.515038074910054 , -0.857167300702112 , -1.66427948235052 ",
            " 11.7984257434817 , 0.719339800338651 , -0.694658370458998 , -0.965688774807075 ",
            " 12.0602251312808 , 0.874619707139396 , -0.484809620246336 , -0.554309051452768 ",
        ]
    )
    fun tanTestMock(x: Double, cosValue: Double, sinValue: Double, expected: Double) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(x)).thenReturn(cosValue)
        Mockito.`when`(spy.sin(x)).thenReturn(sinValue)
        Assertions.assertEquals(expected, spy.tan(x), 0.02 * max(1.0, abs(expected)))
    }

    @ParameterizedTest
    @CsvSource(
        value = [
            " 1.5707963267949 , 1 ",
            " 4.71238898038469 , -1 ",
            " -4.71238898038469 , 1 ",
            " -1.5707963267949 , -1 ",
            " 7.85398163397448 , 1 ",
            " 10.9955742875643 , -1 ",
        ]
    )
    fun tanTestInfinityMock(x: Double, sinValue: Double) {
        val spy = Mockito.spy(Algebra(0.0))
        Mockito.`when`(spy.cos(x)).thenReturn(0.0)
        Mockito.`when`(spy.sin(x)).thenReturn(sinValue)
        Assertions.assertTrue(abs(spy.tan(x)) > 1e10)
    }
}
